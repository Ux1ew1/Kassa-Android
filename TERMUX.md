# Запуск на Android через Termux

Инструкция по установке и запуску приложения кассы на Android устройстве через Termux.

## Шаг 1: Установка Termux

1. Установите **Termux** из [F-Droid](https://f-droid.org/packages/com.termux/) (рекомендуется) или Google Play
2. Откройте Termux

## Шаг 2: Обновление системы

```bash
pkg update && pkg upgrade
```

## Шаг 3: Установка Node.js

```bash
pkg install nodejs git
```

Проверьте установку:
```bash
node --version
npm --version
```

## Шаг 4: Копирование проекта на телефон

### Вариант 1: Через Git (если проект в репозитории)
```bash
git clone <URL_вашего_репозитория>
cd Kassa-React
```

### Вариант 2: Через USB (ADB)

1. На компьютере в папке с проектом:
```bash
# Создайте архив проекта
tar -czf kassa-react.tar.gz Kassa-React
# Или zip
# 7z a -tzip kassa-react.zip Kassa-React
```

2. Переместите архив на телефон через USB или облачное хранилище

3. В Termux распакуйте:
```bash
# Перейдите в нужную папку (например, Downloads)
cd ~/storage/downloads
# Или создайте папку для проектов
mkdir -p ~/projects
cd ~/projects

# Распакуйте архив (замените путь на ваш)
tar -xzf ~/storage/downloads/kassa-react.tar.gz
# Или для zip:
# unzip ~/storage/downloads/kassa-react.zip

cd Kassa-React
```

### Вариант 3: Через облачное хранилище

1. Загрузите папку `Kassa-React` в Google Drive/OneDrive
2. В Termux установите rclone или используйте веб-интерфейс для скачивания

### Вариант 4: Создание проекта вручную в Termux

```bash
mkdir -p ~/projects/kassa-react
cd ~/projects/kassa-react
# Затем скопируйте файлы вручную через редактор termux или другими способами
```

## Шаг 5: Установка зависимостей

```bash
cd Kassa-React
npm install
```

⚠️ **Примечание**: Установка может занять несколько минут на мобильном устройстве.

## Шаг 6: Настройка для работы по сети

Для доступа с других устройств в той же сети WiFi нужно изменить host в server.js:

```bash
nano server.js
```

Найдите строку:
```javascript
const HOST = "0.0.0.0";
```

Убедитесь, что она именно такая (не `localhost`), это позволит принимать подключения извне.

## Шаг 7: Получение IP адреса устройства

```bash
ifconfig | grep inet
```

Или проще:
```bash
ip addr show wlan0 | grep inet
```

Запишите IP адрес (например, `192.168.1.100`)

## Шаг 8: Разрешение доступа к файлам (для Android 11+)

Если нужно работать с файлами из памяти телефона:

```bash
termux-setup-storage
```

Это запросит разрешение на доступ к хранилищу.

## Шаг 9: Запуск приложения

### Режим разработки (рекомендуется для начала):

**Терминал 1** - Backend:
```bash
npm run server
```

**Терминал 2** - Frontend:
```bash
npm run dev
```

### Режим продакшена:

```bash
# Сборка (может занять время на мобильном)
npm run build

# Запуск
npm start
```

## Шаг 10: Доступ к приложению

### На самом телефоне:
- Откройте браузер
- Перейдите на `http://localhost:3000` (продакшен) или `http://localhost:5173` (разработка)

### С другого устройства в той же сети WiFi:
- Откройте браузер
- Перейдите на `http://<IP_ТЕЛЕФОНА>:3000` (например, `http://192.168.1.100:3000`)

## Полезные команды Termux

```bash
# Разделить терминал на две панели (удобно для запуска двух процессов)
termux-split-terminal

# Включить автозапуск при открытии Termux
# Создайте файл ~/.bashrc и добавьте команды запуска

# Просмотр активных процессов
ps aux | grep node

# Остановка процесса (найдите PID и выполните)
kill <PID>

# Фоновая работа
nohup npm start > server.log 2>&1 &
```

## Решение проблем

### Проблема: Порт занят
```bash
# Найти процесс на порту 3000
lsof -i :3000
# Или
netstat -tulpn | grep 3000

# Убить процесс
kill <PID>
```

### Проблема: Не могу подключиться с другого устройства
1. Убедитесь, что оба устройства в одной WiFi сети
2. Проверьте firewall на телефоне (отключите или разрешите доступ)
3. Убедитесь что в server.js `HOST = "0.0.0.0"`, а не `localhost`

### Проблема: Termux закрывается при блокировке экрана
Используйте wakelock:
```bash
termux-wake-lock
```

Отключить:
```bash
termux-wake-unlock
```

### Проблема: Недостаточно места
```bash
# Очистка кеша npm
npm cache clean --force

# Удаление node_modules и переустановка
rm -rf node_modules
npm install
```

## Оптимизация для мобильного устройства

Для экономии ресурсов можно использовать только режим продакшена без Vite dev сервера.

## Автозапуск при открытии Termux

Создайте файл `~/.bashrc`:
```bash
nano ~/.bashrc
```

Добавьте:
```bash
cd ~/projects/Kassa-React
# Раскомментируйте, если хотите автозапуск:
# npm start
```

Сохраните: `Ctrl+X`, затем `Y`, затем `Enter`

